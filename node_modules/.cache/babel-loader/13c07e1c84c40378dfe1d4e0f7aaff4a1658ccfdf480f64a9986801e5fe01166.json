{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{getArticleContent,getArticleImages}from'../api/wikipedia';import{addToHistory}from'../services/historyService';import{formatTitleForDisplay,formatTitleForUrl}from'../utils/titleUtils';import'./ArticlePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ArticlePage=()=>{const{title}=useParams();const navigate=useNavigate();const[content,setContent]=useState('');const[heroImage,setHeroImage]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const handleBack=()=>{navigate(-1);};useEffect(()=>{const fetchArticle=async()=>{if(!title)return;setLoading(true);setError(null);try{var _tempDiv$querySelecto;const[articleContent,articleImages]=await Promise.all([getArticleContent(title),getArticleImages(title)]);// Process the HTML content to handle internal links\nconst processedContent=processWikipediaContent(articleContent);setContent(processedContent);if(articleImages.length>0){setHeroImage(articleImages[0]);}// Add to history when successfully loaded\nconst tempDiv=document.createElement('div');tempDiv.innerHTML=articleContent;const firstParagraph=((_tempDiv$querySelecto=tempDiv.querySelector('p'))===null||_tempDiv$querySelecto===void 0?void 0:_tempDiv$querySelecto.textContent)||'';// Store the decoded title in history\nconst displayTitle=formatTitleForDisplay(title);addToHistory(displayTitle,firstParagraph,articleImages[0]);}catch(err){setError('Failed to load article');console.error('Error loading article:',err);}finally{setLoading(false);}};fetchArticle();},[title]);const processWikipediaContent=htmlContent=>{const tempDiv=document.createElement('div');tempDiv.innerHTML=htmlContent;// Process internal links\ntempDiv.querySelectorAll('a').forEach(link=>{const href=link.getAttribute('href');if(href!==null&&href!==void 0&&href.startsWith('/wiki/')){const articleTitle=href.replace('/wiki/','');// Store the decoded title as the data attribute and update link text\nconst displayTitle=formatTitleForDisplay(articleTitle);link.setAttribute('data-article',articleTitle);link.textContent=displayTitle;// Update the visible text\nlink.removeAttribute('href');link.classList.add('wiki-link');}});// Remove edit links and other Wikipedia UI elements\ntempDiv.querySelectorAll('.mw-editsection').forEach(el=>el.remove());return tempDiv.innerHTML;};const handleWikiLinkClick=event=>{const target=event.target;const wikiLink=target.closest('.wiki-link');if(wikiLink){const articleTitle=wikiLink.getAttribute('data-article');if(articleTitle){navigate(\"/article/\".concat(formatTitleForUrl(articleTitle)));}}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"article-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"article-loading\",children:\"Loading article...\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"article-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"article-error\",children:error})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"article-page\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"back-button\",onClick:handleBack,children:[/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",className:\"back-icon\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\",fill:\"currentColor\"})}),\"Back\"]}),heroImage?/*#__PURE__*/_jsx(\"div\",{className:\"article-hero\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"hero-image-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:heroImage.url,alt:heroImage.description||'Article hero image',loading:\"eager\"}),/*#__PURE__*/_jsx(\"div\",{className:\"hero-overlay\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"article-title\",children:formatTitleForDisplay(title||'')})})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"article-hero no-image\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"article-title\",children:formatTitleForDisplay(title||'')})}),/*#__PURE__*/_jsx(\"article\",{className:\"article-content\",onClick:handleWikiLinkClick,dangerouslySetInnerHTML:{__html:content}})]});};export default ArticlePage;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","getArticleContent","getArticleImages","addToHistory","formatTitleForDisplay","formatTitleForUrl","jsx","_jsx","jsxs","_jsxs","ArticlePage","title","navigate","content","setContent","heroImage","setHeroImage","loading","setLoading","error","setError","handleBack","fetchArticle","_tempDiv$querySelecto","articleContent","articleImages","Promise","all","processedContent","processWikipediaContent","length","tempDiv","document","createElement","innerHTML","firstParagraph","querySelector","textContent","displayTitle","err","console","htmlContent","querySelectorAll","forEach","link","href","getAttribute","startsWith","articleTitle","replace","setAttribute","removeAttribute","classList","add","el","remove","handleWikiLinkClick","event","target","wikiLink","closest","concat","className","children","onClick","viewBox","d","fill","src","url","alt","description","dangerouslySetInnerHTML","__html"],"sources":["/Users/haleynordeen/Desktop/Wikipedia App Prototyping/src/pages/ArticlePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { getArticleContent, getArticleImages, ArticleImage } from '../api/wikipedia';\nimport { addToHistory } from '../services/historyService';\nimport { formatTitleForDisplay, formatTitleForUrl } from '../utils/titleUtils';\nimport './ArticlePage.css';\n\nconst ArticlePage: React.FC = () => {\n  const { title } = useParams<{ title: string }>();\n  const navigate = useNavigate();\n  const [content, setContent] = useState<string>('');\n  const [heroImage, setHeroImage] = useState<ArticleImage | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleBack = () => {\n    navigate(-1);\n  };\n\n  useEffect(() => {\n    const fetchArticle = async () => {\n      if (!title) return;\n      \n      setLoading(true);\n      setError(null);\n      \n      try {\n        const [articleContent, articleImages] = await Promise.all([\n          getArticleContent(title),\n          getArticleImages(title)\n        ]);\n\n        // Process the HTML content to handle internal links\n        const processedContent = processWikipediaContent(articleContent);\n        setContent(processedContent);\n        \n        if (articleImages.length > 0) {\n          setHeroImage(articleImages[0]);\n        }\n\n        // Add to history when successfully loaded\n        const tempDiv = document.createElement('div');\n        tempDiv.innerHTML = articleContent;\n        const firstParagraph = tempDiv.querySelector('p')?.textContent || '';\n        \n        // Store the decoded title in history\n        const displayTitle = formatTitleForDisplay(title);\n        addToHistory(\n          displayTitle,\n          firstParagraph,\n          articleImages[0]\n        );\n      } catch (err) {\n        setError('Failed to load article');\n        console.error('Error loading article:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchArticle();\n  }, [title]);\n\n  const processWikipediaContent = (htmlContent: string): string => {\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = htmlContent;\n\n    // Process internal links\n    tempDiv.querySelectorAll('a').forEach(link => {\n      const href = link.getAttribute('href');\n      if (href?.startsWith('/wiki/')) {\n        const articleTitle = href.replace('/wiki/', '');\n        // Store the decoded title as the data attribute and update link text\n        const displayTitle = formatTitleForDisplay(articleTitle);\n        link.setAttribute('data-article', articleTitle);\n        link.textContent = displayTitle; // Update the visible text\n        link.removeAttribute('href');\n        link.classList.add('wiki-link');\n      }\n    });\n\n    // Remove edit links and other Wikipedia UI elements\n    tempDiv.querySelectorAll('.mw-editsection').forEach(el => el.remove());\n    \n    return tempDiv.innerHTML;\n  };\n\n  const handleWikiLinkClick = (event: React.MouseEvent) => {\n    const target = event.target as HTMLElement;\n    const wikiLink = target.closest('.wiki-link');\n    if (wikiLink) {\n      const articleTitle = wikiLink.getAttribute('data-article');\n      if (articleTitle) {\n        navigate(`/article/${formatTitleForUrl(articleTitle)}`);\n      }\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"article-page\">\n        <div className=\"article-loading\">Loading article...</div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"article-page\">\n        <div className=\"article-error\">{error}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"article-page\">\n      <button className=\"back-button\" onClick={handleBack}>\n        <svg viewBox=\"0 0 24 24\" className=\"back-icon\">\n          <path d=\"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\" fill=\"currentColor\"/>\n        </svg>\n        Back\n      </button>\n      {heroImage ? (\n        <div className=\"article-hero\">\n          <div className=\"hero-image-container\">\n            <img\n              src={heroImage.url}\n              alt={heroImage.description || 'Article hero image'}\n              loading=\"eager\"\n            />\n            <div className=\"hero-overlay\">\n              <h1 className=\"article-title\">{formatTitleForDisplay(title || '')}</h1>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"article-hero no-image\">\n          <h1 className=\"article-title\">{formatTitleForDisplay(title || '')}</h1>\n        </div>\n      )}\n\n      <article \n        className=\"article-content\"\n        onClick={handleWikiLinkClick}\n        dangerouslySetInnerHTML={{ __html: content }}\n      />\n    </div>\n  );\n};\n\nexport default ArticlePage; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,SAAS,CAAEC,WAAW,KAAQ,kBAAkB,CACzD,OAASC,iBAAiB,CAAEC,gBAAgB,KAAsB,kBAAkB,CACpF,OAASC,YAAY,KAAQ,4BAA4B,CACzD,OAASC,qBAAqB,CAAEC,iBAAiB,KAAQ,qBAAqB,CAC9E,MAAO,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE3B,KAAM,CAAAC,WAAqB,CAAGA,CAAA,GAAM,CAClC,KAAM,CAAEC,KAAM,CAAC,CAAGZ,SAAS,CAAoB,CAAC,CAChD,KAAM,CAAAa,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGjB,QAAQ,CAAS,EAAE,CAAC,CAClD,KAAM,CAACkB,SAAS,CAAEC,YAAY,CAAC,CAAGnB,QAAQ,CAAsB,IAAI,CAAC,CACrE,KAAM,CAACoB,OAAO,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACsB,KAAK,CAAEC,QAAQ,CAAC,CAAGvB,QAAQ,CAAgB,IAAI,CAAC,CAEvD,KAAM,CAAAwB,UAAU,CAAGA,CAAA,GAAM,CACvBT,QAAQ,CAAC,CAAC,CAAC,CAAC,CACd,CAAC,CAEDd,SAAS,CAAC,IAAM,CACd,KAAM,CAAAwB,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CAACX,KAAK,CAAE,OAEZO,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,IAAI,CAAC,CAEd,GAAI,KAAAG,qBAAA,CACF,KAAM,CAACC,cAAc,CAAEC,aAAa,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CACxD1B,iBAAiB,CAACU,KAAK,CAAC,CACxBT,gBAAgB,CAACS,KAAK,CAAC,CACxB,CAAC,CAEF;AACA,KAAM,CAAAiB,gBAAgB,CAAGC,uBAAuB,CAACL,cAAc,CAAC,CAChEV,UAAU,CAACc,gBAAgB,CAAC,CAE5B,GAAIH,aAAa,CAACK,MAAM,CAAG,CAAC,CAAE,CAC5Bd,YAAY,CAACS,aAAa,CAAC,CAAC,CAAC,CAAC,CAChC,CAEA;AACA,KAAM,CAAAM,OAAO,CAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC,CAC7CF,OAAO,CAACG,SAAS,CAAGV,cAAc,CAClC,KAAM,CAAAW,cAAc,CAAG,EAAAZ,qBAAA,CAAAQ,OAAO,CAACK,aAAa,CAAC,GAAG,CAAC,UAAAb,qBAAA,iBAA1BA,qBAAA,CAA4Bc,WAAW,GAAI,EAAE,CAEpE;AACA,KAAM,CAAAC,YAAY,CAAGlC,qBAAqB,CAACO,KAAK,CAAC,CACjDR,YAAY,CACVmC,YAAY,CACZH,cAAc,CACdV,aAAa,CAAC,CAAC,CACjB,CAAC,CACH,CAAE,MAAOc,GAAG,CAAE,CACZnB,QAAQ,CAAC,wBAAwB,CAAC,CAClCoB,OAAO,CAACrB,KAAK,CAAC,wBAAwB,CAAEoB,GAAG,CAAC,CAC9C,CAAC,OAAS,CACRrB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDI,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,CAACX,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAkB,uBAAuB,CAAIY,WAAmB,EAAa,CAC/D,KAAM,CAAAV,OAAO,CAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC,CAC7CF,OAAO,CAACG,SAAS,CAAGO,WAAW,CAE/B;AACAV,OAAO,CAACW,gBAAgB,CAAC,GAAG,CAAC,CAACC,OAAO,CAACC,IAAI,EAAI,CAC5C,KAAM,CAAAC,IAAI,CAAGD,IAAI,CAACE,YAAY,CAAC,MAAM,CAAC,CACtC,GAAID,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEE,UAAU,CAAC,QAAQ,CAAC,CAAE,CAC9B,KAAM,CAAAC,YAAY,CAAGH,IAAI,CAACI,OAAO,CAAC,QAAQ,CAAE,EAAE,CAAC,CAC/C;AACA,KAAM,CAAAX,YAAY,CAAGlC,qBAAqB,CAAC4C,YAAY,CAAC,CACxDJ,IAAI,CAACM,YAAY,CAAC,cAAc,CAAEF,YAAY,CAAC,CAC/CJ,IAAI,CAACP,WAAW,CAAGC,YAAY,CAAE;AACjCM,IAAI,CAACO,eAAe,CAAC,MAAM,CAAC,CAC5BP,IAAI,CAACQ,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC,CACjC,CACF,CAAC,CAAC,CAEF;AACAtB,OAAO,CAACW,gBAAgB,CAAC,iBAAiB,CAAC,CAACC,OAAO,CAACW,EAAE,EAAIA,EAAE,CAACC,MAAM,CAAC,CAAC,CAAC,CAEtE,MAAO,CAAAxB,OAAO,CAACG,SAAS,CAC1B,CAAC,CAED,KAAM,CAAAsB,mBAAmB,CAAIC,KAAuB,EAAK,CACvD,KAAM,CAAAC,MAAM,CAAGD,KAAK,CAACC,MAAqB,CAC1C,KAAM,CAAAC,QAAQ,CAAGD,MAAM,CAACE,OAAO,CAAC,YAAY,CAAC,CAC7C,GAAID,QAAQ,CAAE,CACZ,KAAM,CAAAX,YAAY,CAAGW,QAAQ,CAACb,YAAY,CAAC,cAAc,CAAC,CAC1D,GAAIE,YAAY,CAAE,CAChBpC,QAAQ,aAAAiD,MAAA,CAAaxD,iBAAiB,CAAC2C,YAAY,CAAC,CAAE,CAAC,CACzD,CACF,CACF,CAAC,CAED,GAAI/B,OAAO,CAAE,CACX,mBACEV,IAAA,QAAKuD,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BxD,IAAA,QAAKuD,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAC,oBAAkB,CAAK,CAAC,CACtD,CAAC,CAEV,CAEA,GAAI5C,KAAK,CAAE,CACT,mBACEZ,IAAA,QAAKuD,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BxD,IAAA,QAAKuD,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAE5C,KAAK,CAAM,CAAC,CACzC,CAAC,CAEV,CAEA,mBACEV,KAAA,QAAKqD,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BtD,KAAA,WAAQqD,SAAS,CAAC,aAAa,CAACE,OAAO,CAAE3C,UAAW,CAAA0C,QAAA,eAClDxD,IAAA,QAAK0D,OAAO,CAAC,WAAW,CAACH,SAAS,CAAC,WAAW,CAAAC,QAAA,cAC5CxD,IAAA,SAAM2D,CAAC,CAAC,8DAA8D,CAACC,IAAI,CAAC,cAAc,CAAC,CAAC,CACzF,CAAC,OAER,EAAQ,CAAC,CACRpD,SAAS,cACRR,IAAA,QAAKuD,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BtD,KAAA,QAAKqD,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnCxD,IAAA,QACE6D,GAAG,CAAErD,SAAS,CAACsD,GAAI,CACnBC,GAAG,CAAEvD,SAAS,CAACwD,WAAW,EAAI,oBAAqB,CACnDtD,OAAO,CAAC,OAAO,CAChB,CAAC,cACFV,IAAA,QAAKuD,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BxD,IAAA,OAAIuD,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAE3D,qBAAqB,CAACO,KAAK,EAAI,EAAE,CAAC,CAAK,CAAC,CACpE,CAAC,EACH,CAAC,CACH,CAAC,cAENJ,IAAA,QAAKuD,SAAS,CAAC,uBAAuB,CAAAC,QAAA,cACpCxD,IAAA,OAAIuD,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAE3D,qBAAqB,CAACO,KAAK,EAAI,EAAE,CAAC,CAAK,CAAC,CACpE,CACN,cAEDJ,IAAA,YACEuD,SAAS,CAAC,iBAAiB,CAC3BE,OAAO,CAAER,mBAAoB,CAC7BgB,uBAAuB,CAAE,CAAEC,MAAM,CAAE5D,OAAQ,CAAE,CAC9C,CAAC,EACC,CAAC,CAEV,CAAC,CAED,cAAe,CAAAH,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}